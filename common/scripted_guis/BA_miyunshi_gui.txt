scripted_gui = {
	miyunshi_window = {
		window_name = miyunshi_window
		context_type = player_context

		ai_enabled = {
			always = no
		}

		visible = {
			check_variable = {
				BA_show_miyunshi_button = 1				
			} 
		}

		effects = {
			miyunshi_button_click = {
				if = {
					limit = {
						check_variable = {
							BA_miyunshi_open = 0
						}
					}
					set_variable = {
						BA_miyunshi_open = 1
					}
				}
				else_if = {
					limit = { 
						check_variable = {
							BA_miyunshi_open = 1
						}
					}
					set_variable = {
						BA_miyunshi_open = 0
					}
					set_variable = {
						BA_miyunshi_select_open = 0
					}
				}			
			}
		}		
	}

	miyunshi_container_window = {
		window_name = miyunshi_container_window
		context_type = player_context

		ai_enabled = {
			always = no
		}

		visible = {
			check_variable = {
				BA_miyunshi_open = 1				
			}
		}

		effects = {
			miyunshi_button_click = {
				if = {
					limit = {
						check_variable = {
							BA_miyunshi_open = 0
						}
					}
					set_variable = {
						BA_miyunshi_open = 1
					}
				}
				else_if = {
					limit = { 
						check_variable = {
							BA_miyunshi_open = 1
						}
					}
					set_variable = {
						BA_miyunshi_open = 0
					}
				}			
			}

			miyunshi_button_conv_click = {
				if = {
					limit = {
						check_variable = {
							BA_miyunshi_point > 0
						}
						# 반말 캐릭터
						OR = {
							check_variable = {
								BA_miyunshi_selected_character = 1
							}
							check_variable = {
								BA_miyunshi_selected_character = 2
							}
							check_variable = {
								BA_miyunshi_selected_character = 3
							}
							check_variable = {
								BA_miyunshi_selected_character = 4
							}
							check_variable = {
								BA_miyunshi_selected_character = 5
							}
							check_variable = {
								BA_miyunshi_selected_character = 9
							}
							check_variable = {
								BA_miyunshi_selected_character = 10
							}
							check_variable = {
								BA_miyunshi_selected_character = 11
							}
						}
					}
					random_list = {
						10 = { 
							country_event = BA_miyunshi_generic_banmal_event.1
							subtract_from_variable = { BA_miyunshi_point = 1 }
						}
						10 = { 
							country_event = BA_miyunshi_generic_banmal_event.2
							subtract_from_variable = { BA_miyunshi_point = 1 }
						}
						10 = { 
							country_event = BA_miyunshi_generic_banmal_event.3
							subtract_from_variable = { BA_miyunshi_point = 1 }
						}
						10 = { 
							country_event = BA_miyunshi_generic_banmal_event.4
							subtract_from_variable = { BA_miyunshi_point = 1 }
						}
						10 = { 
							country_event = BA_miyunshi_generic_banmal_event.5
							subtract_from_variable = { BA_miyunshi_point = 1 }
						}
						10 = { 
							country_event = BA_miyunshi_generic_banmal_event.6
							subtract_from_variable = { BA_miyunshi_point = 1 }
						}
						10 = { 
							country_event = BA_miyunshi_generic_banmal_event.7
							subtract_from_variable = { BA_miyunshi_point = 1 }
						}
						10 = { 
							country_event = BA_miyunshi_generic_banmal_event.8
							subtract_from_variable = { BA_miyunshi_point = 1 }
						}
						10 = { 
							country_event = BA_miyunshi_generic_banmal_event.9
							subtract_from_variable = { BA_miyunshi_point = 1 }
						}
						10 = { 
							country_event = BA_miyunshi_generic_banmal_event.10
							subtract_from_variable = { BA_miyunshi_point = 1 }
						}
					}
				}
				else_if = {
					limit = {
						check_variable = {
							BA_miyunshi_point > 0
						}
						#  존댓말 캐릭터
						OR = {
							check_variable = {
								BA_miyunshi_selected_character = 6
							}
							check_variable = {
								BA_miyunshi_selected_character = 7
							}
							check_variable = {
								BA_miyunshi_selected_character = 8
							}
							check_variable = {
								BA_miyunshi_selected_character = 12
							}
							check_variable = {
								BA_miyunshi_selected_character = 13
							}
							check_variable = {
								BA_miyunshi_selected_character = 14
							}
						}
					}
					random_list = {
						10 = { 
							country_event = BA_miyunshi_generic_zondae_event.1
							subtract_from_variable = { BA_miyunshi_point = 1 }
						}
						10 = { 
							country_event = BA_miyunshi_generic_zondae_event.2
							subtract_from_variable = { BA_miyunshi_point = 1 }
						}
						10 = { 
							country_event = BA_miyunshi_generic_zondae_event.3
							subtract_from_variable = { BA_miyunshi_point = 1 }
						}
						10 = { 
							country_event = BA_miyunshi_generic_zondae_event.4
							subtract_from_variable = { BA_miyunshi_point = 1 }
						}
						10 = { 
							country_event = BA_miyunshi_generic_zondae_event.5
							subtract_from_variable = { BA_miyunshi_point = 1 }
						}
						10 = { 
							country_event = BA_miyunshi_generic_zondae_event.6
							subtract_from_variable = { BA_miyunshi_point = 1 }
						}
						10 = { 
							country_event = BA_miyunshi_generic_zondae_event.7
							subtract_from_variable = { BA_miyunshi_point = 1 }
						}
						10 = { 
							country_event = BA_miyunshi_generic_zondae_event.8
							subtract_from_variable = { BA_miyunshi_point = 1 }
						}
						10 = { 
							country_event = BA_miyunshi_generic_zondae_event.9
							subtract_from_variable = { BA_miyunshi_point = 1 }
						}
						10 = { 
							country_event = BA_miyunshi_generic_zondae_event.10
							subtract_from_variable = { BA_miyunshi_point = 1 }
						}
					}
				}
				else_if = {
					limit = { 
						check_variable = {
							BA_miyunshi_point < 1
						}
					}
					country_event = BA_miyunshi_generic_event.1
				}
			}

			miyunshi_button_change_student_click = {
				if = {
					limit = {
						check_variable = {
							BA_miyunshi_select_open = 0
						}
					}
					set_variable = {
						BA_miyunshi_select_open = 1
					}
				}
				else_if = {
					limit = {
						check_variable = {
							BA_miyunshi_select_open = 1
						}
					}
					set_variable = {
						BA_miyunshi_select_open = 0
					}
				}
			}

			miyunshi_button_close_click = {
				if = {
					limit = {
						check_variable = {
							BA_miyunshi_open = 1
						}
					}
					set_variable = {
						BA_miyunshi_open = 0
					}
					set_variable = {
						BA_miyunshi_select_open = 0						
					}
				}
			}
		}

		properties = {
			center_student = {
				image = [ROOT.GetMiyunshiArchiveSelectedCharacterGfx]
			}
		}
	}

	miyunshi_change_student_window = {
		window_name = miyunshi_change_student_window
		context_type = player_context

		ai_enabled = {
			always = no
		}

		visible = {
			check_variable = {
				BA_miyunshi_select_open = 1
			}		
		}

		effects = {
			btn_change_to_mutsuki_click = {
				set_variable = {
					BA_miyunshi_selected_character = 1
				}
			}
			btn_change_to_azusa_click = {
				set_variable = {
					BA_miyunshi_selected_character = 2
				}
			}
			btn_change_to_aru_click = {
				set_variable = {
					BA_miyunshi_selected_character = 3
				}
			}
			btn_change_to_hina_click = {
				set_variable = {
					BA_miyunshi_selected_character = 4
				}
			}
			btn_change_to_hoshino_click = {
				set_variable = {
					BA_miyunshi_selected_character = 5
				}
			}
			btn_change_to_iroha_click = {
				set_variable = {
					BA_miyunshi_selected_character = 6
				}
			}
			btn_change_to_izuna_click = {
				set_variable = {
					BA_miyunshi_selected_character = 7
				}
			}
			btn_change_to_kanna_click = {
				set_variable = {
					BA_miyunshi_selected_character = 8
				}
			}
			btn_change_to_kisaki_click = {
				set_variable = {
					BA_miyunshi_selected_character = 9
				}
			}
			btn_change_to_marina_click = {
				set_variable = {
					BA_miyunshi_selected_character = 10
				}
			}
			btn_change_to_mika_click = {
				set_variable = {
					BA_miyunshi_selected_character = 11
				}
			}
			btn_change_to_miyako_click = {
				set_variable = {
					BA_miyunshi_selected_character = 12
				}
			}
			btn_change_to_rin_click = {
				set_variable = {
					BA_miyunshi_selected_character = 13
				}
			}
			btn_change_to_yuuka_click = {
				set_variable = {
					BA_miyunshi_selected_character = 14
				}
			}
		}
		
		triggers = {
			btn_change_to_azusa_visible = {
				85 = {
					is_controlled_by = ROOT
				}
				64 = {
					is_controlled_by = ROOT
				}
			}
			btn_change_to_mutsuki_visible = {
				8 = {
					is_controlled_by = ROOT
				}
			}
			btn_change_to_aru_visible = {
				8 = {
					is_controlled_by = ROOT
				}
			}
			btn_change_to_hina_visible = {
				52 = {
					is_controlled_by = ROOT
				}
			}
			btn_change_to_hoshino_visible = {
				985 = {
					is_controlled_by = ROOT
				}
			}
			btn_change_to_iroha_visible = {
				55 = {
					is_controlled_by = ROOT
				}
			}
			btn_change_to_izuna_visible = {
				9 = {
					is_controlled_by = ROOT
				}
			}
			btn_change_to_kanna_visible = {
				34 = {
					is_controlled_by = ROOT
				}
			}
			btn_change_to_kisaki_visible = {
				4 = {
					is_controlled_by = ROOT
				}
			}
			btn_change_to_marina_visible = {
				141 = {
					is_controlled_by = ROOT
				}
			}
			btn_change_to_mika_visible = {
				64 = {
					is_controlled_by = ROOT
				}
			}
			btn_change_to_mika_visible = {
				64 = {
					is_controlled_by = ROOT
				}
			}
			btn_change_to_miyako_visible = {
				14 = {
					is_controlled_by = ROOT
				}
			}
			btn_change_to_rin_visible = {
				35 = {
					is_controlled_by = ROOT
				}
			}
		}

	}
}